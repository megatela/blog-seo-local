---
import { sanityClient } from "sanity:client";

export const prerender = false;

// 1. Datos del Caso de Ã‰xito y Posts
const mainCase = await sanityClient.fetch(`*[_type == "caseStudy" && slug.current == "clinica-dental-sonrisas-valencia"][0]`);
const clusterPosts = await sanityClient.fetch(`*[_type == "post"] | order(_createdAt desc) [0...10]`);

// 2. Mapeo de Iconos (SVG) segÃºn palabras clave en el tÃ­tulo
const getIcon = (title) => {
  const t = title.toLowerCase();
  if (t.includes('maps') || t.includes('local pack')) return 'ğŸ“';
  if (t.includes('ia') || t.includes('inteligencia')) return 'ğŸ¤–';
  if (t.includes('link') || t.includes('enlaces')) return 'ğŸ”—';
  if (t.includes('audit') || t.includes('auditoria')) return 'ğŸ”';
  if (t.includes('perfil') || t.includes('business')) return 'ğŸ¢';
  if (t.includes('nap') || t.includes('consistencia')) return 'ğŸ“‹';
  if (t.includes('schema') || t.includes('markup')) return 'âš¡';
  if (t.includes('mensaje') || t.includes('chat')) return 'ğŸ’¬';
  return 'ğŸ“'; // Icono por defecto
};
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Local SEO Architect | Resultados Reales</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-50 text-slate-900">

    <header class="relative bg-slate-900 py-24 px-6 overflow-hidden">
      <div class="absolute inset-0 opacity-20">
        <div class="absolute -top-24 -left-24 w-96 h-96 bg-blue-500 rounded-full blur-3xl"></div>
      </div>

      <div class="relative z-10 max-w-5xl mx-auto text-center">
        <span class="inline-block bg-blue-500/20 text-blue-400 px-4 py-1 rounded-full text-sm font-bold mb-6 border border-blue-500/30">
          CASO DE Ã‰XITO DESTACADO
        </span>
        <h1 class="text-4xl md:text-6xl font-black text-white mb-8 leading-tight">
          CÃ³mo duplicamos las citas de una ClÃ­nica Dental en el centro de Valencia en 4 meses
        </h1>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href={`/casos-de-exito/${mainCase?.slug?.current}`} class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-bold text-lg transition-all shadow-lg shadow-blue-900/20">
            Ver Resultado Detallado
          </a>
          <a href="/casos-de-exito" class="bg-slate-800 hover:bg-slate-700 text-slate-200 px-8 py-4 rounded-xl font-bold text-lg transition-all border border-slate-700">
            Todos los Casos de Ã‰xito
          </a>
        </div>
      </div>
    </header>

    <main class="max-w-7xl mx-auto py-20 px-6">
      <div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6">
        <div>
          <h2 class="text-3xl font-bold text-slate-900">Base de Conocimiento</h2>
          <p class="text-slate-500 mt-2 text-lg">Explora nuestro clÃºster de expertos en SEO Local.</p>
        </div>
        <div class="h-1 w-24 bg-blue-600 rounded-full hidden md:block"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {clusterPosts.map((post) => (
          <a href={`/blog/${post.slug.current}`} class="group bg-white border border-slate-200 p-6 rounded-2xl hover:border-blue-500 hover:shadow-xl hover:shadow-blue-500/5 transition-all duration-300 flex flex-col justify-between">
            <div>
              <div class="text-4xl mb-6 group-hover:scale-110 transition-transform duration-300">
                {getIcon(post.title)}
              </div>
              <h3 class="font-bold text-xl text-slate-800 group-hover:text-blue-600 transition-colors leading-snug">
                {post.title}
              </h3>
            </div>
            
            <div class="mt-8 pt-4 border-t border-slate-50 flex items-center justify-between text-sm font-bold text-slate-400 group-hover:text-blue-600 transition-colors">
              LEER ARTÃCULO
              <span class="transform group-hover:translate-x-2 transition-transform">â†’</span>
            </div>
          </a>
        ))}
      </div>
    </main>

  </body>
</html>