---
import { client } from '../../lib/sanity';
import { PortableText } from '@portabletext/react';
import Layout from '../../layouts/Layout.astro';

export const prerender = false;
const { slug } = Astro.params;

const post = await client.fetch(`*[_type == "caseStudy" && slug.current == $slug][0]{
  title,
  metaDescription,
  "content": body
}`, { slug });

if (!post) return Astro.redirect('/404');
---

<Layout title={post.title} description={post.metaDescription}>
  <article class="max-w-3xl mx-auto py-12 px-6">
    <h1 class="text-4xl font-bold mb-6">{post.title}</h1>
    <div class="prose">
      {post.content ? (
        <PortableText value={post.content} />
      ) : (
        <p>Esperando contenido del editor...</p>
      )}
    </div>
  </article>
</Layout>
