---
import { client } from '../../lib/sanity';
import { PortableText } from '@portabletext/react';
import Layout from '../../layouts/Layout.astro';

export const prerender = false;
const { slug } = Astro.params;

const post = await client.fetch(`*[_type == "caseStudy" && slug.current == $slug][0]{
  title,
  "content": body,
  metrics
}`, { slug });

if (!post) return Astro.redirect('/404');
---

<Layout title={post.title}>
  <article class="max-w-2xl mx-auto py-20 px-4">
    <h1 class="text-4xl font-bold mb-8">{post.title}</h1>
    
    <div class="prose prose-blue">
      {post.content ? (
        <PortableText value={post.content} />
      ) : (
        <p>Escribiendo contenido...</p>
      )}
    </div>
  </article>
</Layout>
