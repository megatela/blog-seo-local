---
// ... (mantenemos tus imports de sanity y react igual)
---

<Layout title={post.title} description={post.metaDescription || ""}>
  <article class="post-container">
    <nav class="breadcrumbs">
      <div class="content-wrapper">
        <a href="/">Inicio</a> / <a href={`/${post.clusterSlug}`}>{post.clusterName}</a> / <span class="current">{post.title}</span>
      </div>
    </nav>

    <main class="post-content">
      {post.mainImage && (
        <div class="image-wrapper">
          <img src={urlFor(post.mainImage).width(1200).url()} alt={post.title} class="main-image" />
        </div>
      )}

      <header class="post-header">
        <h1 class="text-4xl md:text-6xl font-black mb-6 uppercase tracking-tighter leading-none">
          {post.title}
        </h1>
        <p class="text-gray-500 italic text-xl">
          Estrategia en <span class="text-blue-600 font-bold">{post.clusterName}</span>
        </p>
      </header>

      <hr class="divider" />

      <div class="rich-text-content">
        <PortableText value={post.content} components={components} />
      </div>

      {related.length > 0 && (
        <section class="related-section">
          <h2 class="related-title text-center">Lecturas recomendadas para tu <br/> <span class="text-blue-600">estrategia local</span></h2>
          <div class="related-grid">
            {related.map((rel, index) => (
              <a href={`/${post.clusterSlug}/${rel.slug.current}`} class="related-card group">
                <span class="card-tag">Siguiente Paso</span>
                <h3 class="card-title">{getDynamicAnchor(rel.title, index)}</h3>
                <span class="card-arrow">Ver metodología →</span>
              </a>
            ))}
          </div>
        </section>
      )}
    </main>
  </article>
</Layout>

<style>
  /* 1. Contenedor General */
  .post-container { background: white; min-height: 100vh; width: 100%; }
  
  /* 2. Envoltorio de contenido centrado (La clave) */
  .content-wrapper, .post-content {
    max-width: 850px; /* Ancho ideal para lectura */
    margin: 0 auto;   /* Centrado horizontal */
    padding: 0 1.5rem;
  }

  .breadcrumbs { background: #fdfdfd; padding: 1.5rem 0; border-bottom: 1px solid #f0f0f0; margin-bottom: 3rem; }

  /* 3. Estética de la Imagen */
  .image-wrapper { margin-bottom: 4rem; width: 100%; }
  .main-image { 
    width: 100%; 
    height: auto; 
    border-radius: 32px; 
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1); 
  }

  /* 4. Encabezado */
  .post-header { text-align: center; margin-bottom: 3rem; }
  .divider { border: 0; border-top: 2px solid #f1f5f9; margin: 4rem auto; max-width: 200px; }

  /* 5. SEPARACIÓN DE PÁRRAFOS Y TEXTOS (Crucial) */
  .rich-text-content {
    line-height: 1.8;
    font-size: 1.25rem;
    color: #334155;
    text-align: left; /* El texto debe estar a la izquierda pero dentro del bloque centrado */
  }

  /* Forzamos espacio entre cada elemento que viene de Sanity */
  .rich-text-content :global(p) {
    margin-bottom: 2.2rem; /* Separación clara entre párrafos */
  }

  .rich-text-content :global(h2) {
    font-size: 2.5rem;
    font-weight: 900;
    margin-top: 4.5rem;
    margin-bottom: 1.5rem;
    color: #0f172a;
    line-height: 1.1;
  }

  .rich-text-content :global(h3) {
    font-size: 1.8rem;
    font-weight: 800;
    margin-top: 3rem;
    margin-bottom: 1.2rem;
    color: #1e293b;
  }

  /* 6. Relacionados */
  .related-section { margin-top: 8rem; padding-bottom: 6rem; }
  .related-grid { display: grid; gap: 1.5rem; margin-top: 3rem; }
  .related-card { 
    background: #f8fafc; 
    padding: 2.5rem; 
    border-radius: 24px; 
    text-decoration: none; 
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  .related-card:hover { transform: translateY(-10px); background: #2563eb; }
</style>
