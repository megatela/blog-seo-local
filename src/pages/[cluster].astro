---
export const prerender = true; // <--- AÑADE ESTA LÍNEA
import { client, urlFor } from '../lib/sanity';
// ... resto del código
import { client, urlFor } from '../lib/sanity';

export async function getStaticPaths() {
  const clusters = await client.fetch(`*[_type == "cluster"]{ "slug": slug.current }`);
  return clusters.map((c: any) => ({
    params: { cluster: c.slug },
  }));
}

const { cluster: slug } = Astro.params;

// Traemos los datos básicos
const clusterData = await client.fetch(`*[_type == "cluster" && slug.current == $slug][0]`, { slug });

if (!clusterData) return Astro.redirect('/404');
---

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Prueba de Clúster</title>
  </head>
  <body style="font-family: sans-serif; padding: 2rem;">
    <h1>Si lees esto, la conexión con Sanity funciona</h1>
    <h2>Título: {clusterData.title}</h2>
    <p>Descripción: {clusterData.description}</p>
    <hr />
    <p>Slug actual: <strong>{slug}</strong></p>
    
    {clusterData.imagenPortada ? (
      <p>✅ Hay una imagen seleccionada.</p>
    ) : (
      <p>❌ No hay imagen en Sanity para este clúster.</p>
    )}
  </body>
</html>